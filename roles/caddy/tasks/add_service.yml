---
- name: setup caddy config
  blockinfile:
    path: "{{ caddy_config_location }}"
    marker: "# {mark} ANSIBLE MANAGED {{ service }}"
    block: "{{ caddyfile_block }}"
    create: yes
    validate: caddy adapt --config %s --validate
  notify:
    - restart reverse proxy
